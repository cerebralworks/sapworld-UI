<section class="sub-header">
	<div class="container  container-big">
		<div class="row">
			<div class="col-lg-5 d-flex align-items-center">
				<button (click)="onRedirectBack();" type="button" class="btn btn-outline-green btn-sm mr-1">
					<i class="fas fa-arrow-left"></i>
				</button>
				<ol class="breadcrumb">
					<li class="breadcrumb-item active" aria-current="page">{{"dashboard.candidateMatches" | translate }}</li>
				</ol>
			</div>
			<div class="col-lg-7 clearfix">
			</div>
		</div>
	</div>
</section>

<!-- //Sub Header Section -->
<section class="my-5">
	<div class="container container-big">
		<div class="row">
			<div [ngClass]="(isMultipleMatches === true)?'col-lg-4':'col-lg-6'">
				<div class="row">
					<div class="col-lg-12">
						<div class="card profile-card border p-2">
							<div class="d-flex">
								<div class="pc-info">
									<a [routerLink]="['/employer/job-detail-view']" href="javascript:;">
										<h5 class="text-capitalize">{{postedJobsDetails?.title}}</h5>
									</a>
									<h6 class="text-capitalize">{{postedJobsDetails?.company?.company}}</h6>
									<h6 class="mb-0 text-capitalize">
										{{postedJobsDetails?.city ? postedJobsDetails?.city+', '  : ''}}
										{{postedJobsDetails?.state ? postedJobsDetails?.state+', '  : ''}}
										<span class="text-uppercase">
										  {{postedJobsDetails?.country ? postedJobsDetails?.country : ''}}
										</span>
									</h6>
								</div>
								<div class="pc-btn">
									<a class="btn btn-outline-blue btn-sm mr-1"
									  (click)="onViewOtherMatches()"
										 href="javascript:;">
										<!-- {{"dashboard.matches" | translate}} -->
										View All Candidates
									</a>
									<a (click)="onToggleJDModal(true)" class="btn btn-outline-blue btn-sm text-right" href="javascript:;">
										<i class="fas fa-file-alt"></i> JD
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<app-shared-job-profile [jobInfo]="postedJobsDetails"  [isMultipleMatches]="isMultipleMatches"[isHideData]="isHideData" 
					[fieldsExclude]="{salary: false, visa_sponsorship: false, end_to_end_implementation: true}">
				</app-shared-job-profile>
			</div>
			<div [ngClass]="(isMultipleMatches === true)?'col-lg-8':'col-lg-6'">
				<div id="carouselProfile" class="carousel slide" data-interval="false" data-ride="carousel">
					<div class="carousel-inner">
						<!--Profile1-->
						<div class="carousel-item active">
							<div class="row">
								<div *ngIf="!utilsHelperService.isEmptyObj(matchingUsers?.profile)" [ngClass]="(isMultipleMatches === true)?'col-lg-6':'col-lg-12'" >
									<div class="info-box">
										<div class="col-lg-12">
											<div class="card profile-card">
												<div class="d-flex">
													<div class="pc-img">
														<img
														  [src]="matchingUsers?.profile?.photo ? (matchingUsers?.meta?.photo?.path+'/'+ matchingUsers?.meta?.photo?.folder+'/'+matchingUsers?.meta?.photo?.sizes?.medium+'/'+matchingUsers?.profile?.photo) : 'assets/images/user-img-icon.jpg'">
													</div>
													<div class="pc-info">
														<a [routerLink]="['/employer/candidate-profile']" [queryParams]="{id: matchingUsers?.profile?.id, jobId: postedJobsDetails?.id}" href="javascript:;">
															<h5 class="text-capitalize">
																<span>{{(matchingUsers?.profile?.first_name ? matchingUsers?.profile?.first_name : '') + ' '
																  + (matchingUsers?.profile?.last_name ? matchingUsers?.profile?.last_name : '')}}</span>
																<small *ngIf="matchingUsers?.profile?.job_role"> -
																  {{matchingUsers?.profile?.job_role}}</small>
															</h5>
														</a>
														<h6 class="mb-0 text-capitalize">
															{{matchingUsers?.profile?.city ? matchingUsers?.profile?.city+', '  : ''}}
															{{matchingUsers?.profile?.state ? matchingUsers?.profile?.state+', '  : ''}}
															<span class="text-uppercase">
																{{matchingUsers?.profile?.country ? matchingUsers?.profile?.country : ''}}
															</span>
														</h6>
														<form class="form-inline">
															<a [class.disabled]="!onGetFilteredValue(matchingUsers?.profile?.doc_resume)" href="javascript:;" (click)="onGetFilteredValue(matchingUsers?.profile?.doc_resume) && onToggleResumeForm(true, (matchingUsersMeta?.doc_resume?.path + '/' + matchingUsersMeta?.doc_resume?.folder + '/' + onGetFilteredValue(matchingUsers?.profile?.doc_resume)))" class="mr-3" data-toggle="modal" data-target="#resumeModal">
																<small><i class="fas fa-file-alt"></i> Resume</small>
															</a><a (click)="OpenMatchPopup(postedJobsDetails,matchingUsers?.profile)" class="mr-3" >
																<small><i class="fab fa-buffer"></i> View Other Matches</small>
															</a>
															<!-- <a [routerLink]="['/employer/job-multiple-candidate-matches']" [queryParams]="{id: matchingUsers?.profile?.id, employeeId: postedJobsDetails?.company.id,path:'userscoring'}" class="mr-3" >
																<small><i class="fab fa-buffer"></i> View Other Matches</small>
															</a> -->
														</form>
													</div>
												</div>
											</div>
											<div class="matchs-info" *ngIf="!isMultipleMatches" style="margin-top: 6px;">
												<button (click)="onShowMatches($event)" id="matchBtnVal" class="matchBtn  btn-sm btn btn-fltr btn-light btn-fltr-active"><img src="assets/images/matchs-icon.png" width="16px"> Matches </button>
												<button (click)="onShowMissing($event)" id="missBtnVal"  class="missBtn  btn-sm btn btn-fltr btn-light "><img src="assets/images/missing-icon.png" width="15px" class="ml-0"> Missing </button>
												<button (click)="onShowMore($event)" id="moreBtnVal"  class="moreBtn  btn-sm btn btn-fltr btn-light btn-fltr-active"><img src="assets/images/info-icon.png"  width="16px">More Skills </button>
												<button (click)="onReset()" class="btn btn-sm btn-light ml-1" style="margin-top: -12px;">
												<i class="fas fa-sync"></i>
												</button>
											</div>
										</div>
																
										<app-shared-user-profile-matches [postedJobsDetails]="postedJobsDetails"  [isMultipleMatches]="isMultipleMatches" 
										[matchedElement]="matchedElement" [missingElement]="missingElement"
										[moreElement]="moreElement" [matchingUsers]="matchingUsers" [matchingUsersNew]="matchingUsersNew">
										</app-shared-user-profile-matches>
										<div class="col-lg-12 info" style="text-align:end;">
											<button (click)="onToggleSendMail(true, matchingUsers?.profile)" type="button" class="btn btn-outline-orange ml-auto"  style="bottom: 15px; right: 15px;"> <i
												class="fas fa-paper-plane"></i> {{"dashboard.sendMail" | translate}}</button>
										</div>
									</div>
								</div>
								<div class="col-lg-6" *ngIf="isMultipleMatches && !utilsHelperService.isEmptyObj(matchingUsersNew?.profile)">
									<div class="info-box">
										<div class="col-lg-12">
											<div class="card profile-card">
												<div class="d-flex">
													<div class="pc-img">
														<img
														  [src]="matchingUsersNew?.profile?.photo ? (matchingUsersNew?.meta?.photo?.path+'/'+ matchingUsersNew?.meta?.photo?.folder+'/'+matchingUsersNew?.meta?.photo?.sizes?.medium+'/'+matchingUsersNew?.profile?.photo) : 'assets/images/user-img-icon.jpg'">
													</div>
													<div class="pc-info">
														<a [routerLink]="['/employer/candidate-profile']" [queryParams]="{id: matchingUsersNew?.profile?.id, jobId: postedJobsDetails?.id}" href="javascript:;">
															<h5 class="text-capitalize">
																<span>{{(matchingUsersNew?.profile?.first_name ? matchingUsersNew?.profile?.first_name : '') + ' '
																  + (matchingUsersNew?.profile?.last_name ? matchingUsersNew?.profile?.last_name : '')}}</span>
																<small *ngIf="matchingUsersNew?.profile?.job_role"> -
																  {{matchingUsersNew?.profile?.job_role}}</small>
															</h5>
														</a>
														<h6 class="mb-0 text-capitalize">
															{{matchingUsersNew?.profile?.city ? matchingUsersNew?.profile?.city+', '  : ''}}
															{{matchingUsersNew?.profile?.state ?  matchingUsersNew?.profile?.state+', '  : ''}}
															<span class="text-uppercase">
																{{matchingUsersNew?.profile?.country ? matchingUsersNew?.profile?.country : ''}}
															</span>
														</h6>
														<form class="form-inline">
															<a [class.disabled]="!onGetFilteredValue(matchingUsersNew?.profile?.doc_resume)" href="javascript:;" (click)="onGetFilteredValue(matchingUsersNew?.profile?.doc_resume) && onToggleResumeForm(true, (matchingUsersMeta?.doc_resume?.path + '/' + matchingUsersMeta?.doc_resume?.folder + '/' + onGetFilteredValue(matchingUsersNew?.profile?.doc_resume)))" class="mr-3" data-toggle="modal" data-target="#resumeModal">
																<small><i class="fas fa-file-alt"></i> Resume</small>
															</a>
															<a (click)="OpenMatchPopup(postedJobsDetails,matchingUsersNew?.profile)" class="mr-3" >
																<small><i class="fab fa-buffer"></i> View Other Matches</small>
															</a><!-- 
															<a [routerLink]="['/employer/job-multiple-candidate-matches']" [queryParams]="{id: matchingUsersNew?.profile?.id, employeeId: postedJobsDetails?.company,path:'userscoring'}"  class="mr-3" >
																<small><i class="fab fa-buffer"></i> View Other Matches</small>
															</a> -->
														</form>
													</div>
												</div>
											</div>
											<div class="matchs-info" *ngIf="!isMultipleMatches">
												<button (click)="onShowMatches()" class="matchBtn btn btn-sm btn-light"><img src="assets/images/matchs-icon.png" width="16px"> Matches </button>
												<button (click)="onShowMissing()" class="missBtn btn btn-sm btn-light"><img src="assets/images/missing-icon.png" width="15px" class="ml-0"> Missing </button>
												<button (click)="onShowMore()" class="moreBtn btn btn-sm btn-light"><img src="assets/images/info-icon.png"  width="16px">More Skills </button>
												<button (click)="onReset()" class="btn btn-sm btn-light ml-1">
												<i class="fas fa-sync"></i>
												</button>
											</div>
										</div>
										<app-shared-user-profile-matches [postedJobsDetails]="postedJobsDetails"  [isMultipleMatches]="isMultipleMatches" 
										[matchedElement]="matchedElement" [missingElement]="missingElement"
										[moreElement]="moreElement" [matchingUsers]="matchingUsersNew" [matchingUsersNew]="matchingUsersNew">
										</app-shared-user-profile-matches>
										<div class="col-lg-12 info" style="text-align:end;">
											<button (click)="onToggleSendMail(true, matchingUsersNew?.profile)" type="button" class="btn btn-outline-orange ml-auto"  style="bottom: 15px; right: 15px;"> <i
												class="fas fa-paper-plane"></i> {{"dashboard.sendMail" | translate}}</button>
										</div>
									</div>
								</div>
							</div>
						</div>
						<!--//Profile1-->
					</div>
					<!--PrevNext-->
					<div class="matchCount" style="top:-45px;">{{page}}/{{matchingUsers?.meta?.count}}</div>
					  <a  *ngIf="page != 1 " (click)="onChangeUser('prev')" class="carousel-control-prev" href="#carouselProfile" role="button"
						data-slide="prev" style="top:-45px;">
						<span class="carousel-control-prev-icon" aria-hidden="true"></span>
						<span class="sr-only">Previous</span>
					  </a>
					  <a *ngIf="page != matchingUsers?.meta?.count " (click)="onChangeUser('next')" class="carousel-control-next" href="#carouselProfile" role="button"
						data-slide="next" style="top:-45px;">
						<span class="carousel-control-next-icon" aria-hidden="true"></span>
						<span class="sr-only">Next</span>
					  </a>
				</div>
			</div>
		</div>
	</div>
</section>

<ng-template *ngIf="toggleMatchModal" #deleteModal let-modal let-d="dismiss">
	<div class="full-width">
		<div class="modal-header bg-dblue text-white">
			<h3 class="modal-title" id="exampleModalLabel">Match Other Posts</h3>
			<button (click)="mbRef?.close()" type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
		
		<div class="modal-body">
			<div class="form-row">
				<div class="col-12 my-2 border-bottom">
					<h6 class="text-blue">Jobs that Match</h6>
				</div>
			</div>
				<div class="form-row">
					<div class="col-12 my-2" *ngFor="let item of postedJobsMatchDetails;">
						<div class="custom-control custom-checkbox mr-sm-2">
							<input type="checkbox" class="custom-control-input" [name]="item?.id" [id]="item?.id" (change) ="updateSelectedTimeslots($event,item?.id)" >
							<label class="custom-control-label font-weight-bold pt-1" [for]="item?.id">{{ item?.title}}</label>
						</div>
					</div>
				</div>
		</div>
		<div class="modal-footer full-width">
			<button type="button" class="btn btn-secondary"
				(click)="mbRef?.close()">Close</button> 
			<button type="button" class="btn btn-theme-blue"
				(click)="MatchCandidate()">Match</button>
		</div>
	</div>
</ng-template>

<app-resume-modal
[url]="selectedResumeUrl"
*ngIf="isOpenedResumeModal"
[toggleResumeModal]="isOpenedResumeModal"
(onEvent)="onToggleResumeForm($event)">
</app-resume-modal>

<app-job-description [isRichTextEnabled]="true" [description]="postedJobsDetails?.description" [toggleJDModal]="isOpenedJDModal" *ngIf="isOpenedJDModal" (onEvent)="onToggleJDModal($event)">
</app-job-description>


<app-match-other-post [togglematchOtherPostModal]="isOpenedOtherPostModal" *ngIf="isOpenedOtherPostModal"
  (onEvent)="onToggleOtherPostModal($event)">
</app-match-other-post>

<app-send-mail-job-preview
*ngIf="isOpenedSendMailModal"
[jobInfo]="postedJobsDetails"
[userInfo]="currentUserInfo"
[toggleSendMailModal]="isOpenedSendMailModal"
(onEvent)="onToggleSendMail($event)">
</app-send-mail-job-preview>
